<h1 class='wi'>Queue Latency</h1>
<p class='intro'>
  The list below shows the queues, number of items in each queue and their respective
  latencies (in seconds) and the last time the latency was updated.
</p>

<table class='queues' style="width: 75%">
  <thead>
    <tr>
      <th>Name</th>
      <th>Count</th>
      <th>Latency</th>
      <th>Since</th>
    </tr>
  </thead>
  <tbody>
<% Resque.queues.sort_by { |q| q.to_s }.each do |queue| %>
  <% latency_updated_at = resque.latency_updated_at(queue) %>
  <tr>
    <td class='queue'><%= queue %></td>
    <td class='size'><%= resque.size queue %></td>
    <td class='latency'><%= resque.latency queue %></td>
    <td class='latency_updated_at <%= latency_updated_at > 1.hour.ago ? 'time' : '' %>'>
      <%= latency_updated_at.strftime("%Y/%m/%d %H:%M:%S %Z") %>
    </td>
  </tr>
<% end %>
  </tbody>
</table>

<%= poll %>
